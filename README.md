Particle tracking algorithm for Poincare plots in a toroidal tokamak